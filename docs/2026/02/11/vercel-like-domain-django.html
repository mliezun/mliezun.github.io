<!DOCTYPE HTML/><html lang="en-US"><head><script type="text/javascript">if (window.location.host === 'mliezun.github.io') {
                    window.location.host = 'mliezun.com';
                }
</script><meta charset="UTF-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><meta name="viewport" content="width=device-width, initial-scale=1"/><title>Vercel-like development setup for Django using Caddy</title><meta name="generator" content="Custom"/><meta property="og:title" content="Vercel-like development setup for Django using Caddy"/><meta property="og:locale" content="en_US"/><meta name="description" content="Get {branch}.dev.yourdomain.com previews for Django (or any WSGI app) with a single VM, Caddy, and rsyncâ€”no Kubernetes required."/><meta property="og:description" content="Get {branch}.dev.yourdomain.com previews for Django (or any WSGI app) with a single VM, Caddy, and rsyncâ€”no Kubernetes required."/><meta name="keywords" content="django,deployment,caddy,ci-cd"/><link rel="canonical" href="https://mliezun.com/2026/02/11/vercel-like-domain-django.html"/><meta property="og:url" content="https://mliezun.com/2026/02/11/vercel-like-domain-django.html"/><meta property="og:site_name" content="mliezun.com"/><meta property="og:image" content="https://mliezun.com/assets/images/vercel-deployment-caddy.png"/><link rel="icon" type="image/x-icon" href="/assets/images/favicon.ico"/><meta property="og:type" content="article"/><meta name="twitter:card" content="summary"/><meta property="twitter:title" content="Vercel-like development setup for Django using Caddy"/><meta name="twitter:creator" content="@migueliezun"/><meta name="twitter:image" content="https://mliezun.com/assets/images/nyc.jpg"/>
<script type="application/ld+json">{"description":"Get {branch}.dev.yourdomain.com previews for Django (or any WSGI app) with a single VM, Caddy, and rsyncâ€”no Kubernetes required.","author":{"@type":"Person","name":"Miguel Liezun"},"@type":"BlogPosting","url":"https://mliezun.com/2026/02/11/vercel-like-domain-django.html","headline":"Vercel-like development setup for Django using Caddy","dateModified":"2026-02-11T00:00:00-03:00","datePublished":"2026-02-11T00:00:00-03:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://mliezun.com/2026/02/11/vercel-like-domain-django.html"},"@context":"https://schema.org"}
</script><link rel="preconnect" href="https://fonts.googleapis.com"/><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin=""/><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&display=swap"/><link rel="stylesheet" href="/assets/css/style.css"/></head><body><div class="body-wrapper"><div class="body-content"><div class="site-header"><header><a href="/" style="text-decoration: none !important">Miguel's dev blog</a></header><button class="theme-toggle" id="theme-toggle" title="Toggle theme"><img src="/assets/images/circle-half.svg"/></button></div><hr/><div class="ai-tag-container"><span class="ai-tag">AI-assisted
<span class="ai-tag-popover">An AI tool was used to generate a part or all content of this post
 
<a href="/2025/11/19/ai-blog.html" class="ai-tag-read-more">Read more</a></span></span></div><article><p>
</p><h1>Vercel-like development setup for Django using Caddy
</h1><p>
</p><p><img alt='' src='/assets/images/vercel-deployment-caddy.png'/>
</p><p>Vercel provides sites like <span class='single-quote'>{branch}.vercel.app</span> that show a preview of your changes and it usually builds really fast, which makes it a seamless experience.
</p><p>This post gets you the same for Django (or any ASGI/WSGI app) on a single VM with Caddy, Python and rsync.
</p><p>On each push, package the commit as a <span class='single-quote'>.tar.gz</span> and rsync it to <span class='single-quote'>/workspace/branches/{branchName}</span>.
</p><p>The VM runs <a target='_blank' href='https://caddyserver.com/'>Caddy</a> with <a target='_blank' href='https://github.com/mliezun/caddy-snake'>caddy-snake</a>. Which means you get automatic HTTPS, support for Websockets and fast static files serving.
</p><p>Your production app runs on <span class='single-quote'>yourdomain.com</span>.
</p><p>Branches get a subdomain like <span class='single-quote'>feature-x.dev.yourdomain.com</span>.
</p><h2>Overview
</h2><p>
</p><div class="mermaid">graph LR
    subgraph repo["Code Repository"]
        main[main]
        featureA[featureA]
        featureB[featureB]
    end

    subgraph cicd["CI/CD Pipeline"]
        pipeline[Build & Deploy]
    end

    subgraph vm["Single VM Server"]
        direction TB
        maindir["ðŸ“ /workspace/branches/main/"]
        fadir["ðŸ“ /workspace/branches/featureA/"]
        fbdir["ðŸ“ /workspace/branches/featureB/"]
        caddy["Caddy Server"]
        
        maindir --> caddy
        fadir --> caddy
        fbdir --> caddy
    end

    subgraph dns["DNS Records"]
        direction TB
        dns1["yourdomain.com<br/>A â†’ serverIP"]
        dns2["*.dev.yourdomain.com<br/>A â†’ serverIP"]
    end

    subgraph domains["Public Access"]
        d1["yourdomain.com"]
        d2["featureA.dev.yourdomain.com"]
        d3["featureB.dev.yourdomain.com"]
    end

    main --> pipeline
    featureA --> pipeline
    featureB --> pipeline
    
    pipeline --> maindir
    pipeline --> fadir
    pipeline --> fbdir
    
    dns1 -.-> vm
    dns2 -.-> vm
    
    caddy --> d1
    caddy --> d2
    caddy --> d3

    style repo fill:#e1f5ff,stroke:#0066cc
    style cicd fill:#fff4e1,stroke:#ff9800
    style vm fill:#f3e5f5,stroke:#9c27b0
    style dns fill:#ffe0e0,stroke:#d32f2f
    style domains fill:#e8f5e9,stroke:#4caf50
    style caddy fill:#c5cae9,stroke:#3f51b5
</div><p>
</p><ul><li><strong>CI/CD</strong>: On each push, build a <span class='single-quote'>.tar.gz</span> and rsync to <span class='single-quote'>/workspace/branches/$BRANCH/</span>.
</li><li><strong>VM</strong>: Caddy + caddy-snake. Production at <span class='single-quote'>yourdomain.com</span>, previews at <span class='single-quote'>*.dev.yourdomain.com</span>.
</li><li><strong>DNS</strong>: A records for <span class='single-quote'>yourdomain.com</span> and <span class='single-quote'>*.dev.yourdomain.com</span> â†’ VM IP.
</li><li><strong>Caddy</strong>: Single configuration file and automatic HTTPS.
</li></ul><h2>1. Deploy pattern: tar.gz + rsync
</h2><p>
</p><p>On every push (e.g. in GitHub Actions or GitLab CI), do something like:
</p><pre class="triple-quote bash"># Example: in CI, after checkout
BRANCH_NAME="${GITHUB_REF#refs/heads/}"
tar -czf app.tar.gz \
  --exclude='.git' \
  --exclude='__pycache__' \
  --exclude='.venv' \
  .
rsync -avz --delete app.tar.gz \
  deploy@YOUR_VM_IP:/workspace/branches/"$BRANCH_NAME"/
ssh deploy@YOUR_VM_IP "cd /workspace/branches/$BRANCH_NAME \
  && tar -xzf app.tar.gz \
  && rm app.tar.gz \
  && uv sync \
  && uv run manage.py migrate \
  && uv run manage.py collectstatic --noinput"
</pre><p>
</p><p>Sanitize branch names in CI if needed (e.g. replace <span class='single-quote'>/</span> with <span class='single-quote'>-</span>) so the path and subdomain match.
</p><p>The server can create the venv per branch with <span class='single-quote'>uv sync</span> (as in the example) or you can ship a pre-built <span class='single-quote'>.venv</span>.
</p><h2>2. Caddy + caddy-snake
</h2><p>
</p><p>Install Caddy with the <a target='_blank' href='https://github.com/mliezun/caddy-snake'>caddy-snake</a> plugin (see repo for build steps; <a target='_blank' href='https://github.com/mliezun/caddy-snake/releases'>releases</a> often include a binary).
</p><h3>Example Caddyfile
</h3><p>
</p><ul><li><strong>Production</strong>: <span class='single-quote'>yourdomain.com</span> â†’ fixed <span class='single-quote'>working_dir</span> for <span class='single-quote'>main</span>.
</li><li><strong>Previews</strong>: <span class='single-quote'>*.dev.yourdomain.com</span> â†’ <span class='single-quote'>working_dir</span> uses the placeholder; <span class='single-quote'>autoreload</span> so the next request after a push serves the new code.
</li></ul><pre class="triple-quote Caddyfile">yourdomain.com {
  handle_path /static/* {
    root * /workspace/branches/main/staticfiles
    file_server
  }
  route {
    python {
      module_wsgi app:wsgi.application
      working_dir /workspace/branches/main/
      venv .venv
    }
  }
}

*.dev.yourdomain.com {
  handle_path /static/* {
    root * /workspace/branches/{http.request.host.labels.3}/staticfiles
    file_server
  }
  route {
    python {
      module_wsgi app:wsgi.application
      working_dir /workspace/branches/{http.request.host.labels.3}/
      venv .venv
      workers_runtime thread
      autoreload
    }
  }
}
</pre><p>
</p><p>Notes:
</p><ul><li><span class='single-quote'>workers_runtime thread</span> is required with placeholders and <span class='single-quote'>autoreload</span>.
</li><li>Use your Django WSGI path (e.g. <span class='single-quote'>mysite.wsgi:application</span>) instead of <span class='single-quote'>app:wsgi.application</span>.
</li><li>The branch directory must exist before the first request (CI creates it). Caddy-snake loads and caches the app on first request; <span class='single-quote'>autoreload</span> watches for <span class='single-quote'>.py</span> changes after each deploy.
</li><li>Set Djangoâ€™s <span class='single-quote'>STATIC_ROOT</span> to <span class='single-quote'>staticfiles</span> so <span class='single-quote'>collectstatic</span> matches the <span class='single-quote'>staticfiles/</span> paths in the Caddyfile.
</li></ul><h3>Subdomain â†’ branch name
</h3><p>
</p><p>Caddy splits the host into labels, <strong>right to left</strong>: for <span class='single-quote'>featureA.dev.yourdomain.com</span>, <span class='single-quote'>labels.0</span> = <span class='single-quote'>com</span>, <span class='single-quote'>labels.1</span> = <span class='single-quote'>yourdomain</span>, <span class='single-quote'>labels.2</span> = <span class='single-quote'>dev</span>, <span class='single-quote'>labels.3</span> = <span class='single-quote'>featureA</span>. So the branch is <span class='single-quote'>{http.request.host.labels.3}</span> for <span class='single-quote'>*.dev.yourdomain.com</span>.
</p><p>Adjust the index if your dev domain has a different structure.
</p><h2>3. DNS configuration
</h2><p>
</p><p>Add an "A record" for <span class='single-quote'>@.dev.yourdomain.com</span> (use wildcard depending on your DNS provider) pointing to the VMâ€™s IP.
</p><p>After propagation, Caddy can obtain a cert for <span class='single-quote'>*.dev.yourdomain.com</span> via ACME and route each subdomain to the matching branch directory.
</p><p>
</p><h2>4. What happens at runtime
</h2><p>
</p><ul><li><strong>First request</strong> to <span class='single-quote'>feature-x.dev.yourdomain.com</span>: Caddy resolves the placeholder to <span class='single-quote'>/workspace/branches/feature-x/</span>; caddy-snake loads and caches the app. If that directory doesnâ€™t exist yet (branch not deployed), the request fails until CI has run.
</li><li><strong>After a push</strong>: CI overwrites the branch directory; the next request triggers <span class='single-quote'>autoreload</span> and serves the new code.
</li><li><strong>New branch</strong>: Push â†’ CI creates the directory â†’ first request to <span class='single-quote'>new-branch.dev.yourdomain.com</span> loads it.
</li></ul><p>Push a branch, wait for CI, then open <span class='single-quote'>{branch}.dev.yourdomain.com</span>.
</p><h2>Bonus: clean up on merge
</h2><p>
</p><p>When a branch is merged and deleted, trigger a pipeline step that removes its directory on the VM (e.g. <span class='single-quote'>ssh deploy@VM "rm -rf /workspace/branches/$BRANCH_NAME"</span>). Caddy-snake sees the directory is gone and stops serving that app; the next request to <span class='single-quote'>{branch}.dev.yourdomain.com</span> fails until a new branch with that name is deployed. That keeps preview URLs only for active branches and frees disk space.
</p></article><footer><hr/><div class="footer-wrapper"><div><div>This blog was made with 
<a target="_blank" href="https://github.com/mliezun/grotsky">Grotsky</a></div><div>Blog
<a target="_blank" href="https://github.com/mliezun/mliezun.com">source code</a></div></div><div class="footer-socials"><a target="_blank" href="https://mliezun.com/feed.xml"><img alt="RSS Feed" src="/assets/images/socials/rss.png" width="20" height="20" style="border-radius: 3px"/></a><a target="_blank" href="https://github.com/mliezun"><img alt="Github" src="/assets/images/socials/github.png" width="20" height="20"/></a><a target="_blank" href="https://x.com/migueliezun"><img alt="X (Twitter)" src="/assets/images/socials/x.ico" width="20" height="20" style="border-radius: 5px"/></a><a target="_blank" href="https://www.linkedin.com/in/miguel-liezun-8697a9168/"><img alt="LinkedIn" src="/assets/images/socials/linkedin.png" width="20" height="20"/></a></div></div></footer></div></div><script src="/assets/js/theme-switcher.js"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.11.1/styles/atom-one-dark.min.css"/><script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.11.1/highlight.min.js"></script><script>document.querySelectorAll('.triple-quote').forEach(function (el) {
                    if (el.classList.length > 1) hljs.highlightElement(el, {language: el.classList[1]});
                    else hljs.highlightElement(el);
                    el.classList.remove('hljs');
                })
</script><script src="https://cdn.jsdelivr.net/npm/mermaid@11/dist/mermaid.min.js"></script><script>mermaid.initialize({ startOnLoad: true });
</script></body></html>